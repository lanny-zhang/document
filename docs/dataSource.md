# Excel 元数据导入用法介绍

## Excel 元数据导入模板说明

### 1、sheet0 为表的元数据导入模板

![表级信息界面](./images/ExcelImport/Excel_Table_Template.png)

#### 表头说明：

-   **“库名”**是表所在的数据库
-   **“表名\*”**是表的英文名称，必填
-   **“表简称”**是表的中文简称。更新模式下不填写，默认不对其进行更新
-   **“表描述”**对该表的功能作描述，如果未修改过，一般为元数据采集时表的注释信息。更新模式下不填写，默认不对其进行更新
-   **“分级”**对该表进行元数据分级。更新模式下不填写，默认不对其进行更新
-   `模板的表头不可更改`

### 2、sheet1..sheetN 为字段的元数据导入模板

![表级信息界面](./images/ExcelImport/Excel_Column_Template.png)

#### 表头说明：

-   **“库名”**是字段所属表所在的数据库
-   **“表名\*”**是字段所属表的英文名称，必填
-   **“字段名\*”**是字段的英文名称，必填
-   **“字段简称”**是字段的中文简称。更新模式下不填写，默认不对其进行更新
-   **“类型”**是字段的类型，如 VARCHAR 类型，新增模式下不填写，默认为 VARCHAR 类型；更新模式下不填写，默认不对其进行更新
-   **“长度”**是字段的类型长度，如 DEMICAL 类型需要指定长度
-   **“精度”**是字段的类型精度，如 DEMICAL 类型需要指定精度
-   **“主键（0|是；1|否）”**指定字段是否为主键，0 代表是，1 代表否，其他数值默认为否。新增模式下不填写，默认该字段不是主键；更新模式下不填写，默认不对其进行更新
-   **“自动递增（0|是；1|否）”**指定字段主键是否自动递增，0 代表是，1 代表否，其他数值默认为否。新增模式下不填写，默认该字段不自动递增；更新模式下不填写，默认不对其进行更新
-   **“默认值”**是字段的默认值，在表中插入一条新记录时，如果没有为该字段赋值，系统就会自动为这个字段插入默认值。更新模式下不填写，默认不对其进行更新
-   **“可空（0|是；1|否）”**指定字段是否能为空值，0 代表是，1 代表否，其他数值默认为否。新增模式下不填写，默认该字段不能为空；更新模式下不填写，默认不对其进行更新
-   **“字段备注”**是对字段的备注，如果未修改过，一般为元数据采集时字段的注释信息。更新模式下不填写，默认不对其进行更新
-   **“分级”**对该字段进行元数据分级。更新模式下不填写，默认不对其进行更新
-   `模板的表头不可更改`

#### 增加 sheet 说明：

-   新增字段的元数据导入 sheet 需要复制相应的表头到第一行

## Excel 元数据导入过程说明

1. 下载 Excel 元数据导入模板，根据 Excel 元数据导入模板说明填充模板

2. 选择要导入的数据源

3. 选择导入模式

    > `新增模式：`数据库中存在相应表的元数据则忽略新增；不存在相应表的元数据则插入数据库
    > `更新模式：`数据库中存在相应表的元数据则进行更新；不存在相应表的元数据则插入数据库
    >
    > **（各导入模式只对数据库原有的数据作插入和更新，不对数据作任何删除）**

4. 选择填充的 Excel 元数据导入模板
5. 确认导入

#### 导入结果说明

-   “字段采集页第 x 行,第 x 列的数据值'xxx'非法”：字段采集 sheet 的**“主键（0|是；1|否）”**，**“自动递增（0|是；1|否）”**，**“可空（0|是；1|否）”**三列的数据值只能为数值型
-   “x 库下已经存在元数据 xx, 不进行导入”：数据库中存在相应表的元数据，导入被忽略
-   “x 数据库下的 xx 表元数据更新成功”：该表的元数据成功更新
-   “x 数据库下的 xx 表元数据插入成功”：数据库不存在该表的元数据，在新增或更新模式下，该表的元数据成功保存到数据库中
-   “分级信息[分级名称]未被定义”：`数据地图-元数据分级`功能中需要预先定义该分级信息，才能在元数据导入中使用

​
